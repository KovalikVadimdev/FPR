20230930204227        #учу/ФП  
___ 
- "Функцiональне програмування" - "Функциональное программирование" (ФП)  
- [[ФП - Лекция 10]]
- -->  [[ФП - UA - Лекцiя 11]]
- <--  [[ФП - UA - Лекцiя 9]]
___
## Тема: "Функціональне програмування на Python - 3" 
- джерело   https://habr.com/ru/post/555378/
### Оператор lambda
- Крім стандартного визначення функції, що складається з заголовка функції з ключовим словом `def` та блоку інструкцій, у Python є можливість створювати короткі однорядкові функції з використанням оператора `lambda`, які називаються _лямбда-функціями_. 
- Формат визначення лямбда-функції:  
- `lambda список_аргументів: вираз` 
- _Список_аргументів_ - це список аргументів, відокремлених комою, і _вираз_ - значення або будь-яка порція програмного коду, яка в результаті дає значення. - Наступні два визначення функцій еквівалентні:

```Python
def standard_function(x, y):
    return x + y
```

- та

```Python
lambda x, y: x + y
```

- На відміну від стандартної функції після визначення лямбда-функції її можна відразу ж застосувати, наприклад, в інтерактивному режимі:

```Python
>>> (lambda x, y: x+y)(5, 7)
12
```

- Або, що цікавіше, присвоїти її змінної, передати в іншу функцію, повернути з функції, розмістити як елемент послідовності або застосувати в програмі як звичайну функцію.

```Python
>>> lambda_function = lambda x, y: x + y
>>> lambda_function(5,7)
12
>>> func = lambda_function
>>> func(3,4)
7
>>> dic = {'функция1': lambda_function}
>>> dic['функция1'](7,8)
15
```

- 1 визначається лямбда-функція та присвоюється змінною, яка тепер посилається на лямбда-функцію. 
- 2 вона застосовується із двома аргументами. 
- 4 посилання на цю функцію присвоюється ще однією змінною, а потім користуючись цією змінною дана функція викликається ще раз. 
- 7 створюється словник, в якому як значення задане посилання на цю функцію, і потім, звернувшись до цього значення ключа, ця функція застосовується втретє.

⭐⭐⭐

### Функцiя map
- Нерідко під час написання програми виникає потреба перетворити якусь послідовність на іншу. Для цих цілей у Python є вбудована функція `map`. 
- Завдання – застосувати спеціальну функцію для всіх елементів у послідовності. У функціональному програмуванні вона називається відображенням (англ. map). - Вбудована в Python функція `map` - це функція вищого порядку, яка призначена для виконання саме такого завдання. Вона дозволяє обробляти одну або кілька послідовностей із використанням заданої функції. 
- Загальний формат функції   `map`:
`map(функция, последовательности)`
- У даному форматі _функція_ - це посилання на стандартну функцію або лямбда-функція, і _послідовності_ - це одна або кілька відокремлених комами послідовностей, що ітеруються, тобто. списки, кортежі, діапазони чи рядкові дані.

```Python
>>> seq = (1, 2, 3, 4, 5, 6, 7, 8, 9)
>>> seq2 = (5, 6, 7, 8, 9, 0, 3, 2, 1)
>>> result = map(lambda_function, seq, seq2)
>>> result
<map object at 0x000002897F7C5B38>
>>> list(result)
[6, 8, 10, 12, 14, 6, 10, 10, 10]
```

- 1 і 2 двом змінним, seq і seq2, присвоюються дві послідовності, що ітеруються. 
- 3 змінної result присвоюється результат застосування функції `map`, в яку як аргументи були передані раніше певна лямбда-функція та дві послідовності. 
- 5 функція `map` повертає об'єкт-послідовність map. Особливість об'єкта-послідовності map полягає в тому він може надавати свої елементи, тільки коли вони потрібні, використовуючи ліниві обчислення. 
- Ліниві обчислення – це стратегія обчислення, згідно з якою обчислення слід відкладати доти, доки не знадобиться їхній результат. 
- Програмістам часто доводиться опрацьовувати послідовності, що складаються з десятків тисяч і навіть мільйонів елементів. Зберігати в оперативної пам'яті, як у певний момент потрібен лише один елемент, немає сенсу. - Ліниві обчислення дозволяють генерувати ліниві послідовності, які при зверненні до них надають наступний елемент послідовності. Щоб показати ліниву послідовність, у разі результат роботи прикладу, необхідно цю послідовність «обчислити». 
- 6 об'єкт map обчислюється під час перетворення на список.
### Функцiя filter
- Функції вищого порядку часто використовуються для фільтрації даних. 
- Мови функціонального програмування пропонують універсальну функцію `filter`, що отримує набір елементів для фільтрації, та фільтруючу функцію, яка визначає, чи потрібно виключити конкретний елемент із послідовності чи ні. 
- Загальний формат функції `filter`: `filter(предикативна_функція, послідовність)` 
- _Предикативная_функция_ – це посилання стандартну функцію чи лямбда-функція, яка повертає істину чи брехня, і _послідовність_ – це итерируемая послідовність, тобто. список, кортеж, діапазон чи рядкові дані. 
- Приклад - однорядкова функція `is_even` для визначення парності числа:

```Python
is_even = lambda x: x % 2 == 0
```

- Щоб відфільтрувати всі числа послідовності та залишити лише парні, застосуємо функцію `filter`:

```Python
>>> seq = (1, 2, 3, 4, 5, 6, 7, 8, 9)
>>> filtered = filter(is_even, seq)
>>> list(filtered)
[2, 4, 6, 8]
```

- По-іншому, помістивши лямбда функцію як перший аргумент:

```Python
>>> filtered = iter(filter(lambda x: x % 2 == 0, seq))
>>> list(filtered)
[2, 4, 6, 8]
```

- І знову, в обох випадках функція `filter` повертає лінивий об'єкт-послідовність, який потрібно обчислити, щоб побачити результат. 
- В іншій ситуації в програмі може бути процес, який споживає по одному елементу за один раз. В цьому випадку в нього можна подавати по одному елементу, викликаючи вбудовану функцію `next`.

```Python
>>> next(filtered)
2
>>> next(filtered)
4
...
```

- **Примітка**. Для запобігання виходу за межі лінивої послідовності необхідно відстежувати виникнення помилки StopIteration. Наприклад,


```Python
seq = sequence
try:
    total = next(seq)
except StopIteration:
    return
```

### Функцiя reduce
- Нарешті, коли потрібно обробити список значень таким чином, щоб звести процес до єдиного результату, використовується функція reduce. 
- Функція `reduce` є у модулі functools стандартної бібліотеки, але тут вона наведена цілком, щоб показати, як вона працює:

```Python
def reduce(fn, seq, initializer=None):
    it = iter(seq)
    value = next(it) if initializer is None else initializer
    for element in it:
        value = fn(value, element)
    return value
```

- Загальний формат функції `reduce`:
`reduce(функция, последовательность, инициализатор)`
- У даному форматі: 
	- _функція_ - це посилання на редукцію функцію; нею може бути стандартна функція або лямбда-функція, 
	- _послідовність_ – це итерируемая послідовність, тобто. список, кортеж, діапазон або рядкові дані, 
	- _ініціалізатор_ - це параметрична змінна, яка отримує початкове значення для накопичувача. 
- Початковим значенням то, можливо значення будь-якого примітивного типу даних чи мутабельний об'єкт – список, кортеж тощо. Початкове значення ініціює накопичувальну змінну, яка перш ніж вона буде повернена, буде оновлюватися функцією, що редукує, по кожному елементу в списку. 
- Передана під час виклику функція викликається у циклі кожного елемента послідовності. Наприклад, функція reduce може застосовуватись для підсумовування числових значень у списку:

```Python
>>> seq = (1, 2, 3, 4, 5, 6, 7, 8, 9)
>>> get_sum = lambda a, b: a + b
>>> summed_numbers = reduce(get_sum, seq)
>>> summed_numbers
45
```

- Ось ще один приклад. Якщо sentences – це список речень, і потрібно підрахувати загальну кількість слів (wsum) у цих реченнях, то можна написати, як показано в наведеному нижче інтерактивному сеансі:

```Python

>>> sentences = ["Варкалось.", 
>>> ...          "Хливкие шорьки пырялись по наве, и", 
>>> ...          "хрюкотали зелюки, как мюмзики в мове."]
>>> wsum = lambda aсс, sentence: aсс + len(sentence.split())
>>> number_of_words = reduce(wsum, sentences, 0)
>>> number_of_words
13
```

- У лямбда-функції, на яку посилається змінна `wsum`, рядковий метод `split` розбиває пропозицію на список слів, функція len підраховує кількість елементів у списку, що вийшов, і додає його в накопичувальну змінну. 
- Переваги функцій вищого ладу? (Вищий порядок) 
	- Вони нерідко складаються з одного рядка. - Усі важливі компоненти ітерації – об'єкт-послідовність, операція та значення, що повертається – знаходяться в одному місці. 
	- Програмний код у звичайному циклі може вплинути на змінні, визначені перед ним, або які йдуть після нього. За визначенням ці функції не мають побічних ефектів. 
	- Вони є елементарними операціями. Дивлячись на цикл `for`, доводиться рядково відстежувати його логіку. При цьому як опору для створення свого розуміння програмного коду доводиться відштовхуватися від кількох структурних закономірностей. Навпаки, функції вищого порядку одночасно є будівельними блоками, які можуть бути інтегровані у складні алгоритми, та елементами, які читач коду може миттєво зрозуміти та резюмувати у своєму розумі. «Цей код перетворює кожен елемент на нову послідовність. Це відкидає деякі елементи. А цей об'єднує елементи, що залишилися, в єдиний результат». 
	- Вони мають велику кількість схожих функцій, які надають можливості, які є доповненням до їхньої основної поведінки. Наприклад, `any`, `all` або їх власні версії.
### Функцiя zip
- Вбудована функція `zip` поєднує окремі елементи з кожної послідовності у кортежі, тобто. вона повертає послідовність, що ітерується, що складається з кортежів. Ось загальний формат функції `zip`:
-  `zip(послідовність, послідовність, ...)` 
- У цьому форматі _послідовність_ – це итерируемая послідовність, тобто. список, кортеж, діапазон чи рядкові дані. Функція `zip` повертає лінивий об'єкт-послідовність, який потрібно обчислити, щоб побачити результат. Наведений нижче інтерактивний сеанс демонструє:

```Python
>>> x = 'абв'
>>> y = 'эюя'
>>> zipped = zip(x, y)
>>> list(zipped)
[('а', 'э'), ('б', 'ю'), ('в', 'я')]
```

- У поєднанні з оператором `*` ця функція використовується для розпакування об'єднаної послідовності (у вигляді пар, трійок тощо) в окремі кортежі:

```Python
>>> x2, y2 = zip(*zip(x, y))
>>> x2
('а', 'б', 'в')
>>> y2
('э', 'ю', 'я')
>>> x == ''.join(x2) and y == ''.join(y2)
True
```

### Функцiя enumerate
- Вбудована функція enumerate повертає індекс елемента і сам елемент послідовності як кортеж. 
- Загальний формат функції enumerate: `enumerate(послідовність)` 
- У цьому форматі _послідовність_ – це итерируемая послідовність, тобто. список, кортеж, діапазон чи рядкові дані. Функція enumerate повертає лінивий об'єкт-послідовність, який потрібно обчислити, щоб побачити результат. 
- Застосування цієї функції до списку літер. В результаті її виконання отримана лінива послідовність зі списком кортежів, де кожен кортеж є індексом і значенням літери.

```Python
>>> lazy = enumerate(['а','б','в'])
>>> list(lazy)
[(0, 'а'), (1, 'б'), (2, 'в')]
```

- 2 застосована функція `list`, яка перетворює ліниву послідовність у список. 
- Функція enumerate також дозволяє застосовувати задану функцію до кожного елемента послідовності з урахуванням індексу:

```Python
>>> convert = lambda tup: tup[1].upper() + str(tup[0])
>>> lazy = map(convert, enumerate(['а','б','в']))
>>> list(lazy)
['А0', 'Б1', 'В2']
```

- Функція `convert` у рядку 1 переводить рядкове значення другого елемента кортежу у верхній регістр і приєднує до нього перетворене на рядковий тип значення першого елемента. Тут `tup` – це кортеж, у якому `tup[0]` – це індекс елемента, і `tup[1]` – рядкове значення елемента.
___ 
### Додатково: 
- Введення у функціональне програмування на Python - https://habr.com/ua/post/257903/ 
- Python/Функціональне програмування на Python - https://ua.wikibooks.org/wiki/Python/Функціональне_програмування_на_Python 
- Основи функціонального програмування на Python - https://habr.com/ua/post/555378/ - можливе продовження наступної лекції.
___ 
- -->  [[ФП - UA - Лекцiя 11]]
- <--  [[ФП - UA - Лекцiя 9]]
___ 
